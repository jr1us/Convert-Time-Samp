/*
*   - Author: jrius ( vk.com/s.fridom | t.me/dcapybarov ) -
*   - Include: Convert Time
*   - ћодуль разработан на версии компил€тора 3.10.8 -
*
*   - ћодуль предоставл€ет следующие функции:
*
*       * ConvertTime(seconds, iterations = 1)
*           -  онвертирует количество секунд в удобочитаемый формат времени
*           ѕараметры:
*           - seconds:  оличество секунд дл€ конвертации
*           - iterations: –ежим вывода результатов:
*              0 : ѕолный формат (все доступные единицы времени)
*              1 : ¬ывести только 1 наибольшую единицу времени
*              2 : ¬ывести 2 наибольшие единицы времени
*              3 : ¬ывести 3 наибольшие единицы времени
*              4 : ¬ывести 4 наибольшие единицы времени
*              5 : ¬ывести 5 наибольших единиц времени
*              6 : ¬ывести 6 наибольших единиц времени
*              7 : ¬ывести все 7 единиц времени (годы, мес€цы, недели, дни, часы, минуты, секунды)
*
*
*    - Ќедели показываютс€ только если их количество ? 4 (28 дней)
*    - ≈диницы времени с нулевым значением пропускаютс€ [!]
*    - ‘ормат слов автоматически склон€етс€ (1 минута, 2 минуты, 5 минут | 1 час, 2 часа, 5 часов)
*
*    - ”становка («акинуть по пути): pawno/include
*    - ”становка (ѕодключить в моде): #include <convert-time>
*
*/

static const UnitTimes[] = {
    31536000, // год
    2592000,  // мес€ц
	604800,	  // недел€
    86400,    // день
    3600,     // час
    60,       // минута
    1         // секунда
};

static const UnitNames[][][] = {
    {"год", "года", "лет"},
    {"мес€ц", "мес€ца", "мес€цев"},
	{"недел€", "недели", "недель"},
    {"день", "дн€", "дней"},
    {"час", "часа", "часов"},
    {"минута", "минуты", "минут"},
    {"секунда", "секунды", "секунд"}
};

const MAX_SIZE_UNIT_TIME = sizeof UnitTimes;
const MIN_SIZE_ITERATION = 0;

stock ConvertTime(seconds, iterations = 1)
{
    new string[128], 
        count, index, type;

    if(iterations > MAX_SIZE_UNIT_TIME)
        iterations = MAX_SIZE_UNIT_TIME;
    
    if(iterations < MIN_SIZE_ITERATION)
        iterations = MIN_SIZE_ITERATION;

    for new i = 0; i < MAX_SIZE_UNIT_TIME; i++ do
    {
        if(i == 3 && iterations != 0 && seconds / UnitTimes[3] <= 28)
            continue;

        count = seconds / UnitTimes[i];
        seconds %= UnitTimes[i];

        if(!count) 
            continue;

        index = 2; 
        type = count % 100;
        
        if(!(type >= 11 && type <= 14))
        {
            switch(count % 10)
            {
                case 1: index = 0;
                case 2..4: index = 1;
            }
        }

        format(string, sizeof(string), "%s%d %s ", string, count, UnitNames[i][index]);

        if(iterations > 0 && i + 1 >= iterations) 
            break;
    }

    return string;
}

/*

“есты проводились:
|
    [ results ]                                                        |   [ Test ]
[----------------------------------------------------------------------------------------------------------------------------------------------------------------------------]
|  1 | 0 секунд                                                        |  printf("%s", ConvertTime(0));                                                                      |   
|  2 | 1 секунда                                                       |  printf("%s", ConvertTime(1));                                                                      |   
|  3 | 2 секунды                                                       |  printf("%s", ConvertTime(2));                                                                      |   
|  4 | 5 секунд                                                        |  printf("%s", ConvertTime(5));                                                                      |   
|  5 | 1 минута                                                        |  printf("%s", ConvertTime(60, -1));                                                                 |   
|  6 | 1 минута 1 секунда                                              |  printf("%s", ConvertTime(61));                                                                     |   
|  7 | 2 минуты                                                        |  printf("%s", ConvertTime(125, 1));                                                                 |   
|  8 | 1 час                                                           |  printf("%s", ConvertTime(3600));                                                                   |   
|  9 | 2 часа 2 минуты 2 секунды                                       |  printf("%s", ConvertTime(3660 * 2 + 2));  [ 7322 seconds ]                                         |
| 10 | 23 часа 59 минут 59 секунд                                      |  printf("%s", ConvertTime(86399));                                                                  |
| 11 | 1 недел€                                                        |  printf("%s", ConvertTime(604800));                                                                 |
| 12 | 2 недели                                                        |  printf("%s", ConvertTime(604800 * 2));    [ 1209600 seconds ]                                      |
| 13 | 3 недели                                                        |  printf("%s", ConvertTime(604800 * 3));    [ 1814400 seconds ]                                      |
| 14 | 4 недели                                                        |  printf("%s", ConvertTime(604800 * 4));    [ 2419200 seconds ]                                      |
| 15 | 1 мес€ц 1 день                                                  |  printf("%s", ConvertTime(2678400));                                                                |
| 16 | 4 мес€ца 1 недел€ 120 часов 49 минут 49 секунд                  |  printf("%s", ConvertTime((5356800 + 5356800 - 1000) + 86441 * 7 + (86441 + 3600 + 60 + 1), 7));    |
| 17 | 1 год 1 мес€ц 1 недел€ 1 день 1 час 6 минут 29 секунд           |  printf("%s", ConvertTime((31536000 + 2592000) + 86441 * 7 + (86441 + 3600 + 60 + 1), 0));          |
| 18 | 2 года 13 часов 53 минуты 20 секунд                             |  printf("%s", ConvertTime(63072000 + 50000, 0));                                                    |
| 19 | 4 года 1 недел€                                                 |  printf("%s", ConvertTime(126144000 + 86400 * 7, 2));                                               |
| 20 | 55 лет 6 мес€цев 1 недел€ 1 день 5 часов 12 минут 22 секунды    |  printf("%s", ConvertTime(gettime()));                                                              |
[----------------------------------------------------------------------------------------------------------------------------------------------------------------------------]


*/